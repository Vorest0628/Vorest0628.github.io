import{r as i,w as T,c as P,j as V,y as o,z as l,A as t,K as w,J as j,aj as E,P as f,a6 as h,O as r,az as F,aF as L,D as R}from"./vendor-CeqXcVya.js";import{b as x}from"./blog-BpxYLf10.js";import{_ as q}from"./index-BH5EIy1g.js";import"./particles-D6-XlEtG.js";const J={class:"blog"},K={class:"blog-filters"},O={class:"search-box"},Q={class:"category-filter"},U=["onClick"],G={class:"blog-list"},H={key:0,class:"loading-state"},S={key:1,class:"error-state"},W=["onClick"],X={class:"post-header"},Y={class:"post-meta"},Z={class:"post-date"},ee={class:"post-category"},se={class:"post-content"},te={class:"post-tags"},ae={key:0,class:"empty-state"},oe={key:1,class:"pagination"},le=["disabled"],ne={class:"page-info"},re=["disabled"],B=5,ie={__name:"Blog",setup(ue){const D=F(),z=L(),u=i(""),c=i("全部"),n=i(1),p=i(!1),v=i(""),m=i([]),y=i(["全部"]),b=i(0);T(()=>z.query.search,e=>{e&&(u.value=e,c.value="全部",n.value=1,d())},{immediate:!0});const d=async()=>{p.value=!0,v.value="";try{const e={page:n.value,pageSize:B,status:"published"};c.value!=="全部"&&(e.category=c.value),u.value&&(e.search=u.value);const s=await x.getBlogs(e);if(s.success)m.value=s.data.blogs||s.data,b.value=s.total;else throw new Error(s.message||"获取博客列表失败")}catch(e){console.error("加载博客失败:",e),v.value=e.message||"加载博客失败，请稍后重试",m.value=[]}finally{p.value=!1}},N=async()=>{try{const e=await x.getCategories();e.success&&(y.value=["全部",...e.data])}catch(e){console.error("加载分类失败:",e),y.value=["全部","前端开发","AI技术","游戏","音乐"]}},k=P(()=>m.value),g=P(()=>Math.ceil(b.value/B)),$=e=>{c.value=e,n.value=1,d()},I=()=>{n.value=1,d()},C=e=>{e>=1&&e<=g.value&&(n.value=e,d())},A=e=>{D.push(`/blog/${e}`)},M=e=>{if(!e)return"未知日期";const s=new Date(e);return isNaN(s.getTime())?(console.warn("Invalid date:",e),"未知日期"):s.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})};return V(async()=>{await N(),await d()}),(e,s)=>(l(),o("div",J,[s[7]||(s[7]=t("h1",null,"我的博客",-1)),t("div",K,[t("div",O,[j(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=a=>u.value=a),placeholder:"搜索文章...",onInput:I},null,544),[[E,u.value]])]),t("div",Q,[(l(!0),o(f,null,h(y.value,a=>(l(),o("button",{key:a,onClick:_=>$(a),class:R([{active:c.value===a},"category-btn"])},r(a),11,U))),128))])]),t("div",G,[p.value?(l(),o("div",H,s[3]||(s[3]=[t("p",null,"正在加载博客文章...",-1)]))):v.value?(l(),o("div",S,[s[4]||(s[4]=t("h3",null,"加载失败",-1)),t("p",null,r(v.value),1),t("button",{onClick:d,class:"retry-btn"},"重试")])):(l(!0),o(f,{key:2},h(k.value,a=>(l(),o("article",{key:a.id,class:"blog-post",onClick:_=>A(a.id)},[t("div",X,[t("h2",null,r(a.title),1),t("div",Y,[t("span",Z,r(M(a.date)),1),t("span",ee,r(a.category),1)])]),t("div",se,[t("p",null,r(a.excerpt),1)]),t("div",te,[(l(!0),o(f,null,h(a.tags,_=>(l(),o("span",{key:_,class:"tag"},r(_),1))),128))]),s[5]||(s[5]=t("div",{class:"post-footer"},[t("span",{class:"read-more"},"阅读更多 →")],-1))],8,W))),128))]),!p.value&&!v.value&&k.value.length===0?(l(),o("div",ae,[s[6]||(s[6]=t("h3",null,"暂无文章",-1)),t("p",null,r(u.value||c.value!=="全部"?"没有找到匹配的文章":"还没有发布任何文章"),1)])):w("",!0),g.value>1?(l(),o("div",oe,[t("button",{onClick:s[1]||(s[1]=a=>C(n.value-1)),disabled:n.value===1,class:"page-btn"}," 上一页 ",8,le),t("span",ne," 第 "+r(n.value)+" 页，共 "+r(g.value)+" 页 ",1),t("button",{onClick:s[2]||(s[2]=a=>C(n.value+1)),disabled:n.value===g.value,class:"page-btn"}," 下一页 ",8,re)])):w("",!0)]))}},ge=q(ie,[["__scopeId","data-v-682d97bc"]]);export{ge as default};
