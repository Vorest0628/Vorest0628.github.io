import{r as u,c as C,j as U,S as V,y as o,z as a,A as e,K as i,H as G,P as p,a6 as m,D as x,O as r,V as K,a1 as W,C as F}from"./vendor-CeqXcVya.js";import{g as H}from"./gallery-JWlZKpVC.js";import{_ as O}from"./index-BH5EIy1g.js";import"./particles-D6-XlEtG.js";const P={class:"modern-gallery"},R={class:"gallery-filters"},q={class:"filter-section"},J={class:"filter-pills"},Q=["onClick"],X={key:0,class:"filter-section"},Y={class:"filter-pills"},Z=["onClick"],ee={key:0,class:"loading-state"},te={key:1,class:"error-state"},se={key:2,class:"masonry-grid"},le=["onClick"],ae={class:"image-container"},oe=["src","alt"],ne={class:"image-overlay"},re={class:"overlay-content"},ie={key:0},ue={class:"image-meta"},ce={class:"category-badge"},de={key:0,class:"tags"},ve={key:0,class:"tag-more"},ge={key:3,class:"empty-state"},ye={class:"lightbox-image"},he=["src","alt"],pe={class:"lightbox-info"},me={key:0},fe={class:"lightbox-meta"},_e={class:"meta-item"},ke={key:0,class:"meta-item"},be={key:1,class:"lightbox-tags"},we={__name:"Gallery",setup(Ce){const d=u("全部"),v=u("全部"),f=u(!1),n=u(null),c=u(0),_=u(!1),h=u(""),g=u([]);u([]),u([]);const E=C(()=>["全部",...new Set(g.value.map(t=>t.category).filter(Boolean))]),T=C(()=>d.value==="全部"?[...new Set(g.value.flatMap(s=>s.secondaryTags||[]))]:[...new Set(g.value.filter(s=>s.category===d.value).flatMap(s=>s.secondaryTags||[]))]),y=C(()=>{let s=g.value;return d.value!=="全部"&&(s=s.filter(t=>t.category===d.value)),v.value!=="全部"&&(s=s.filter(t=>t.secondaryTags&&t.secondaryTags.includes(v.value))),s}),L=async()=>{_.value=!0,h.value="";try{const s=await H.getImages({page:1,limit:100});if(s.success)g.value=s.data.images||[];else throw new Error(s.message||"获取图片失败")}catch(s){console.error("获取图片失败:",s),h.value=s.message||"获取图片失败，请稍后重试",g.value=[]}finally{_.value=!1}},$=s=>{d.value=s,v.value="全部"},z=s=>{v.value=s},D=(s,t)=>{n.value=s,c.value=t,f.value=!0,document.body.style.overflow="hidden"},b=()=>{f.value=!1,n.value=null,document.body.style.overflow="auto"},I=()=>{c.value>0&&(c.value--,n.value=y.value[c.value])},B=()=>{c.value<y.value.length-1&&(c.value++,n.value=y.value[c.value])},M=s=>{if(!s)return"/placeholder.jpg";if(s.startsWith("http"))return s;const t="http://localhost:3000";return s.startsWith("/")?`${t}${s}`:`${t}/${s}`},A=s=>{s.target.src="/placeholder.jpg"},j=s=>new Date(s).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}),N=()=>d.value!=="全部"||v.value!=="全部"?"没有找到匹配的图片，请尝试其他筛选条件":"还没有上传任何图片",S=s=>{if(f.value)switch(s.key){case"Escape":b();break;case"ArrowLeft":I();break;case"ArrowRight":B();break}};return U(()=>{L(),document.addEventListener("keydown",S)}),V(()=>{document.removeEventListener("keydown",S),document.body.style.overflow="auto"}),(s,t)=>(a(),o("div",P,[t[13]||(t[13]=e("div",{class:"gallery-header"},[e("h1",null,"图库展示"),e("p",{class:"subtitle"},"精选作品集合")],-1)),e("div",R,[e("div",q,[t[2]||(t[2]=e("h3",null,"分类",-1)),e("div",J,[(a(!0),o(p,null,m(E.value,l=>(a(),o("button",{key:l,onClick:k=>$(l),class:x([{active:d.value===l},"filter-pill"])},r(l),11,Q))),128))])]),T.value.length>0?(a(),o("div",X,[t[3]||(t[3]=e("h3",null,"标签",-1)),e("div",Y,[e("button",{onClick:t[0]||(t[0]=l=>z("全部")),class:x([{active:v.value==="全部"},"filter-pill"])}," 全部 ",2),(a(!0),o(p,null,m(T.value,l=>(a(),o("button",{key:l,onClick:k=>z(l),class:x([{active:v.value===l},"filter-pill"])},r(l),11,Z))),128))])])):i("",!0)]),_.value?(a(),o("div",ee,t[4]||(t[4]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"正在加载图片...",-1)]))):h.value?(a(),o("div",te,[t[5]||(t[5]=e("div",{class:"error-icon"},"😞",-1)),t[6]||(t[6]=e("h3",null,"加载失败",-1)),e("p",null,r(h.value),1),e("button",{onClick:L,class:"retry-btn"},"重试")])):(a(),o("div",se,[(a(!0),o(p,null,m(y.value,(l,k)=>(a(),o("div",{key:l._id||l.id,class:"masonry-item",style:F({animationDelay:k*50+"ms"}),onClick:w=>D(l,k)},[e("div",ae,[e("img",{src:M(l.thumbnail),alt:l.title,loading:"lazy",onError:A},null,40,oe),e("div",ne,[e("div",re,[e("h4",null,r(l.title),1),l.description?(a(),o("p",ie,r(l.description),1)):i("",!0),e("div",ue,[e("span",ce,r(l.category),1),l.secondaryTags&&l.secondaryTags.length?(a(),o("div",de,[(a(!0),o(p,null,m(l.secondaryTags.slice(0,3),w=>(a(),o("span",{key:w,class:"tag-badge"},r(w),1))),128)),l.secondaryTags.length>3?(a(),o("span",ve," +"+r(l.secondaryTags.length-3),1)):i("",!0)])):i("",!0)])]),t[7]||(t[7]=e("div",{class:"overlay-actions"},[e("button",{class:"action-btn view-btn"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"})])])],-1))])])],12,le))),128))])),!_.value&&!h.value&&y.value.length===0?(a(),o("div",ge,[t[8]||(t[8]=e("div",{class:"empty-icon"},"🖼️",-1)),t[9]||(t[9]=e("h3",null,"暂无图片",-1)),e("p",null,r(N()),1)])):i("",!0),(a(),G(W,{to:"body"},[f.value?(a(),o("div",{key:0,class:"lightbox-overlay",onClick:b},[e("div",{class:"lightbox-container",onClick:t[1]||(t[1]=K(()=>{},["stop"]))},[e("button",{class:"lightbox-close",onClick:b},t[10]||(t[10]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)])),e("div",ye,[e("img",{src:M(n.value.fullSize||n.value.thumbnail),alt:n.value.title},null,8,he)]),e("div",pe,[e("h3",null,r(n.value.title),1),n.value.description?(a(),o("p",me,r(n.value.description),1)):i("",!0),e("div",fe,[e("span",_e,"分类："+r(n.value.category),1),n.value.date?(a(),o("span",ke,r(j(n.value.date)),1)):i("",!0)]),n.value.secondaryTags&&n.value.secondaryTags.length?(a(),o("div",be,[(a(!0),o(p,null,m(n.value.secondaryTags,l=>(a(),o("span",{key:l,class:"lightbox-tag"},r(l),1))),128))])):i("",!0)]),c.value>0?(a(),o("button",{key:0,onClick:I,class:"lightbox-nav prev"},t[11]||(t[11]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})],-1)]))):i("",!0),c.value<y.value.length-1?(a(),o("button",{key:1,onClick:B,class:"lightbox-nav next"},t[12]||(t[12]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})],-1)]))):i("",!0)])])):i("",!0)]))]))}},Ie=O(we,[["__scopeId","data-v-88c5ae56"]]);export{Ie as default};
