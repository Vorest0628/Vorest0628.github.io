import{r as i,j as S,S as I,y as o,z as c,A as t,O as a,K as m,P as h,a6 as y,aA as L,az as P}from"./vendor-CeqXcVya.js";import{b as A}from"./blog-BpxYLf10.js";import{d as $}from"./document-BdgFPKhx.js";import{_ as V}from"./index-BH5EIy1g.js";import"./particles-D6-XlEtG.js";const j={class:"home"},E={class:"datetime-section"},H={class:"current-date"},q={class:"current-time"},F={class:"main-content"},K={class:"pinned-section"},M={key:0,class:"pinned-category"},O={class:"pinned-cards"},U=["onClick"],G={class:"card-content"},J={class:"card-title"},Q={class:"card-meta"},W={class:"card-date"},X={class:"card-category"},Y={class:"card-excerpt"},Z={class:"pinned-category"},tt={class:"pinned-cards"},st=["onClick"],et={class:"card-content"},nt={class:"card-title"},at={class:"card-meta"},ot={class:"card-date"},ct={class:"card-category"},it={class:"card-excerpt"},rt={key:1,class:"no-pinned"},dt={class:"recent-section"},lt={key:0,class:"loading-state"},ut={key:1,class:"error-state"},pt={key:2,class:"recent-blogs"},vt=["onClick"],_t={class:"blog-content"},gt={class:"blog-title"},mt={class:"blog-description"},ht={class:"blog-meta"},yt={class:"blog-date"},ft={class:"blog-category"},kt={key:0,class:"blog-tags"},Dt={key:3,class:"no-recent"},Bt={__name:"Home",setup(wt){const p=P(),f=i(""),k=i(""),r=i([]),d=i([]),l=i([]),v=i(!1),u=i("");let _=null;const D=()=>{const s=new Date;f.value=s.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",weekday:"long"}),k.value=s.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit"})},B=async()=>{v.value=!0,u.value="";try{const[s,e,n]=await Promise.all([x(),N(),b()]);console.log("内容加载完成:",{pinnedDocs:s.length,pinnedBlogs:e.length,recentBlogs:n.length})}catch(s){console.error("加载内容失败:",s),u.value="加载内容失败，请稍后重试"}finally{v.value=!1}},x=async()=>{try{const s=await $.getDocuments({status:"pinned",limit:5});if(s.success){const e=s.data.documents||s.data||[];return r.value=e.filter(n=>n.status==="pinned"),r.value}return[]}catch(s){return console.warn("加载置顶文档失败:",s),r.value=[],[]}},N=async()=>{try{const s=await A.getBlogs({status:"pinned",limit:5});if(s.success){const e=s.data.blogs||s.data||[];return d.value=e.filter(n=>n.status==="pinned"),d.value}return[]}catch(s){return console.warn("加载置顶博客失败:",s),d.value=[],[]}},b=async()=>{try{const s=await A.getBlogs({status:"published",limit:5,sort:"-publishedAt,-createdAt"});return s.success?(l.value=s.data||[],l.value):[]}catch(s){return console.warn("加载最近博客失败:",s),l.value=[],[]}},w=s=>{const e=s.id||s._id;p.push(`/blog/${e}`)},T=()=>{p.push("/readme")},R=s=>{p.push({path:"/documents",query:{search:s.title}})},g=s=>{if(!s)return"未知时间";const e=new Date(s);return isNaN(e.getTime())?"未知时间":e.toLocaleDateString("zh-CN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},z=s=>s.description?s.description:s.content?s.content.length>100?s.content.substring(0,100)+"...":s.content:"暂无描述";return S(()=>{D(),_=setInterval(D,1e3),B()}),I(()=>{_&&clearInterval(_)}),(s,e)=>(c(),o("div",j,[t("div",E,[t("div",H,a(f.value),1),t("div",q,a(k.value),1),e[0]||(e[0]=t("div",{class:"welcome-message"},"欢迎来到我的个人网站",-1))]),t("div",F,[t("section",K,[e[7]||(e[7]=t("h2",{class:"section-title"},"📌 置顶内容",-1)),r.value.length>0?(c(),o("div",M,[e[2]||(e[2]=t("h3",{class:"category-title"},"🗂️ 置顶文档",-1)),t("div",O,[(c(!0),o(h,null,y(r.value,n=>(c(),o("div",{key:n._id,class:"pinned-card document-card",onClick:C=>R(n)},[e[1]||(e[1]=t("div",{class:"card-icon"},"📄",-1)),t("div",G,[t("h4",J,a(n.title),1),t("p",Q,[t("span",W,a(g(n.createdAt)),1),t("span",X,a(n.category),1)]),t("p",Y,a(z(n)),1)])],8,U))),128))])])):m("",!0),t("div",Z,[e[5]||(e[5]=t("h3",{class:"category-title"},"📝 置顶博客",-1)),t("div",tt,[t("div",{class:"pinned-card blog-card special-blog",onClick:T},e[3]||(e[3]=[L('<div class="card-icon" data-v-6de22c7a>📖</div><div class="card-content" data-v-6de22c7a><h4 class="card-title" data-v-6de22c7a>📖 网站使用指南</h4><p class="card-meta" data-v-6de22c7a><span class="card-date" data-v-6de22c7a>永久置顶</span><span class="card-category" data-v-6de22c7a>使用指南</span></p><p class="card-excerpt" data-v-6de22c7a>详细的使用说明和常见问题解答，帮助您更好地使用网站功能</p></div>',2)])),(c(!0),o(h,null,y(d.value,n=>(c(),o("div",{key:n._id,class:"pinned-card blog-card",onClick:C=>w(n)},[e[4]||(e[4]=t("div",{class:"card-icon"},"✍️",-1)),t("div",et,[t("h4",nt,a(n.title),1),t("p",at,[t("span",ot,a(g(n.publishedAt||n.createdAt)),1),t("span",ct,a(n.category),1)]),t("p",it,a(n.description||n.excerpt),1)])],8,st))),128))])]),r.value.length===0&&d.value.length===0?(c(),o("div",rt,e[6]||(e[6]=[t("div",{class:"no-content-icon"},"📌",-1),t("p",null,"暂无置顶内容",-1)]))):m("",!0)]),t("section",dt,[e[12]||(e[12]=t("h2",{class:"section-title"},"📰 最近博客",-1)),v.value?(c(),o("div",lt,e[8]||(e[8]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"正在加载内容...",-1)]))):u.value?(c(),o("div",ut,[e[9]||(e[9]=t("div",{class:"error-icon"},"❌",-1)),t("p",null,a(u.value),1),t("button",{onClick:B,class:"retry-btn"},"重试")])):l.value.length>0?(c(),o("div",pt,[(c(!0),o(h,null,y(l.value,n=>(c(),o("div",{key:n._id,class:"blog-item",onClick:C=>w(n)},[t("div",_t,[t("h3",gt,a(n.title),1),t("p",mt,a(n.description||n.excerpt||"暂无描述"),1),t("div",ht,[t("span",yt,a(g(n.publishedAt||n.createdAt)),1),t("span",ft,a(n.category),1),n.tags&&n.tags.length>0?(c(),o("span",kt,a(n.tags.slice(0,3).join(", ")),1)):m("",!0)])]),e[10]||(e[10]=t("div",{class:"blog-arrow"},"→",-1))],8,vt))),128))])):(c(),o("div",Dt,e[11]||(e[11]=[t("div",{class:"no-content-icon"},"📝",-1),t("p",null,"暂无最近博客",-1)])))])])]))}},Tt=V(Bt,[["__scopeId","data-v-6de22c7a"]]);export{Tt as default};
